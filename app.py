 have chaned some codes please verify it.

